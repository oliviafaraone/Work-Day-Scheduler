<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <title>Work Day Scheduler</title>
  </head>

  <body>
    <header class="jumbotron">
      <h1 class="display-3">Work Day Scheduler</h1>
      <p class="lead">A simple calendar app for scheduling your work day</p>
      <p id="currentDay" class="lead"></p>
    </header>
    <div class="container">
      <!-- Timeblocks go here -->
      <div class="row">
        <div class="col-2">
          <p>9AM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=AM9 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-9" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>
      
       <div class="row">
        <div class="col-2">
          <p>10AM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=AM10 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-10" class="btn btn-block btn-info border-top border-left" 
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>

       <div class="row">
        <div class="col-2">
          <p>11AM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=AM11 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-11" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>

       <div class="row">
        <div class="col-2">
          <p>12PM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=PM12 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-12" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>

       <div class="row">
        <div class="col-2">
          <p>1PM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=PM1 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-1" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>

       <div class="row">
        <div class="col-2">
          <p>2PM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=PM2 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-2" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>
        
       <div class="row">
        <div class="col-2">
          <p>3PM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=PM3 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-3" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>

       <div class="row">
        <div class="col-2">
          <p>4PM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=PM4 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-4" class="btn btn-block btn-info"
          img= "./unamed.png"> Save Button </button>
        </div>
      </div>

       <div class="row">
        <div class="col-2">
          <p>5PM</p>
        </div>
        <div class="col-8 hourlyTask border border-white" id=PM5 contenteditable="true">
        </div>
        <div class="col-2">
          <button id="save-task-5" class="btn btn-block btn-info">Save Button </button>
        </div>
      </div>

      </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script type="text/javascript">
      //Display current time in id=currentDay
      let [month, date, year]  = new Date().toLocaleDateString("en-US").split("/")
      let fmtDate = (month + '/' + date + '/' + year);
      let fmtDay = moment(fmtDate,'MM/DD/YYY');
      currentDay= fmtDay.format('dddd, MMMM Do') ;
  
      let displayDay= document.getElementById('currentDay');
      displayDay.textContent = currentDay;
  
      // Color hour box based on current time
      let [hour, minute, second] = new Date().toLocaleTimeString("en-GB").split(/:| /)
      function currentTime(){

        if (hour == '9'){
          document.getElementById('AM9').classList.add('bg-danger');
        } else if(hour < moment().hour(9)){
          document.getElementById('AM9').classList.add('bg-light');
        } else {
          document.getElementById('AM9').classList.add('bg-success');
        }

        if (hour == '10'){
          document.getElementById('AM10').classList.add('bg-danger');
        } else if(hour < moment().hour(10)){
          document.getElementById('AM10').classList.add('bg-light');
        } else {
          document.getElementById('AM10').classList.add('bg-success');
        }

        if (hour == '11'){
          document.getElementById('AM11').classList.add('bg-danger');
        } else if(hour < moment().hour(19)){
          document.getElementById('AM11').classList.add('bg-light');
        } else {
          document.getElementById('AM11').classList.add('bg-success');
        }

        if (hour == '12'){
          document.getElementById('PM12').classList.add('bg-danger');
        } else if(hour < moment().hour(12)){
          document.getElementById('PM12').classList.add('bg-light');
        } else {
          document.getElementById('PM12').classList.add('bg-success');
        }

        if (hour == '13'){
          document.getElementById('PM1').classList.add('bg-danger');
        } else if(hour < moment().hour(1)){
          document.getElementById('PM1').classList.add('bg-light');
        } else {
          document.getElementById('PM1').classList.add('bg-success');
        }

        if (hour == '14'){
          document.getElementById('PM2').classList.add('bg-danger');
        } else if(hour < moment().hour(2)){
          document.getElementById('PM2').classList.add('bg-light');
        } else {
          document.getElementById('PM2').classList.add('bg-success');
        }


        if (hour == '12'){
          document.getElementById('PM3').classList.add('bg-danger');
        } else if(hour < moment().hour(3)){
          document.getElementById('PM3').classList.add('bg-light');
        } else {
          document.getElementById('PM3').classList.add('bg-success');
        }

        if (hour == '16'){
          document.getElementById('PM4').classList.add('bg-danger');
        } else if(hour < moment().hour(4)){
          document.getElementById('PM4').classList.add('bg-light');
        } else {
          document.getElementById('PM4').classList.add('bg-success');
        }

        if (hour == '17'){
          document.getElementById('PM5').classList.add('bg-danger');
        } else if(hour < moment().hour(5)){
          document.getElementById('PM5').classList.add('bg-light');
        } else {
          document.getElementById('PM5').classList.add('bg-success');
        }

      };
      currentTime();

      //Edit text box for each hour
      $(".hourlyTask").on("click", "p", function() {
      var text=$(this)
        .text() 
        .trim();
      console.log(text);
      
      var textInput= $("<textarea>")
       // .addClass("form-control")
        .val(text);
      $(this).replaceWith(textInput)
      textInput.trigger("focus");

    });

    $(".hourlyTask").on("blur","textarea", function(){
      var text = $(this)
        .val()
        .trim();

      var taskP = $("<p>")
       // .addClass("m-1")
        .text(text);

      $(this).replaceWith(taskP);
    });
  

      //Enable Save button with local storage
      // Renders our to-dos to the page
      function renderSchedule9() {
          let savedText9= JSON.parse(localStorage.getItem('todoitem9'))
          $('#AM9').text(savedText9);
        }

        $('#save-task-9').on('click', function(event) {
       event.preventDefault();

        var textEntry9 = $('#AM9').text().trim();
        localStorage.setItem('todoitem9',JSON.stringify(textEntry9));
            });

      renderSchedule9();

      function renderSchedule10() {
          let savedText10= JSON.parse(localStorage.getItem('todoitem10'))
          $('#AM10').text(savedText10);
        }

        $('#save-task-10').on('click', function(event) {
       event.preventDefault();

        var textEntry10 = $('#AM10').text().trim();
        localStorage.setItem('todoitem10',JSON.stringify(textEntry10));
            });

      renderSchedule10();

      function renderSchedule11() {
          let savedText11= JSON.parse(localStorage.getItem('todoitem11'))
          $('#AM11').text(savedText11);
        }

        $('#save-task-11').on('click', function(event) {
       event.preventDefault();

        var textEntry11 = $('#AM11').text().trim();
        localStorage.setItem('todoitem11',JSON.stringify(textEntry11));
            });

      renderSchedule11();

      function renderSchedule12() {
          let savedText12= JSON.parse(localStorage.getItem('todoitem12'))
          $('#PM12').text(savedText12);
        }

        $('#save-task-12').on('click', function(event) {
       event.preventDefault();

        var textEntry12 = $('#PM12').text().trim();
        localStorage.setItem('todoitem12',JSON.stringify(textEntry12));
            });

      renderSchedule12();

      function renderSchedule1() {
          let savedText1= JSON.parse(localStorage.getItem('todoitem1'))
          $('#PM1').text(savedText1);
        }

        $('#save-task-1').on('click', function(event) {
       event.preventDefault();

        var textEntry1 = $('#PM1').text().trim();
        localStorage.setItem('todoitem1',JSON.stringify(textEntry1));
            });

      renderSchedule1();

      function renderSchedule2() {
          let savedText2= JSON.parse(localStorage.getItem('todoitem2'))
          $('#PM2').text(savedText2);
        }

        $('#save-task-2').on('click', function(event) {
       event.preventDefault();

        var textEntry2 = $('#PM2').text().trim();
        localStorage.setItem('todoitem2',JSON.stringify(textEntry2));
            });

      renderSchedule2();

      function renderSchedule3() {
          let savedText3= JSON.parse(localStorage.getItem('todoitem3'))
          $('#PM3').text(savedText3);
        }

        $('#save-task-3').on('click', function(event) {
       event.preventDefault();

        var textEntry3 = $('#PM3').text().trim();
        localStorage.setItem('todoitem3',JSON.stringify(textEntry3));
            });

      renderSchedule3();

      function renderSchedule4() {
          let savedText= JSON.parse(localStorage.getItem('todoitem4'))
          $('#PM4').text(savedText);
        }

        $('#save-task-4').on('click', function(event) {
       event.preventDefault();

        var textEntry4 = $('#PM4').text().trim();
        localStorage.setItem('todoitem4',JSON.stringify(textEntry4));
            });

      renderSchedule4();

      function renderSchedule5() {
          let savedText5= JSON.parse(localStorage.getItem('todoitem5'))
          $('#PM5').text(savedText5);
        }

        $('#save-task-5').on('click', function(event) {
       event.preventDefault();

        var textEntry5 = $('#PM5').text().trim();
        localStorage.setItem('todoitem5',JSON.stringify(textEntry5));
            });

      renderSchedule5();

      </script>

  </body>
</html>
